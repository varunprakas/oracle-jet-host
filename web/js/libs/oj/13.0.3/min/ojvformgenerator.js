/**
 * @license
 * Copyright (c) 2014, 2022, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["exports","preact/jsx-runtime","preact","ojs/ojthemeutils","ojs/ojlabel","ojs/ojcustomelement-utils","ojs/ojdomutils"],function(e,t,l,o,s,n,a){"use strict";function r(e){const s=function(e,t){let l=e;if(t>1){const s=/^([+-]?(?:\d+|\d*\.\d+))([a-z]*|%)$/,n=e.match(s),a=parseFloat(n[1]);switch(n[2]){case"vw":case"vmin":case"vmax":case"%":if(t>1){let s=o.parseJSONFromFontFamily("oj-form-layout-option-defaults").columnGap;l="calc((("+e+" / "+t+") - (("+s+" * ("+(t-1)+") * "+a/t/100+")))"}}}return l}(e.labelWidth,e.colspan),n="calc(100% - "+s+")",a={flexGrow:"0",flexShrink:"0",flexBasis:s,width:s,maxWidth:s},r={flexGrow:"1",flexShrink:"1",flexBasis:n,width:n,maxWidth:n};return Array.isArray(e.children)||(e.children.props.labelEdge="provided"),t.jsxs(l.Fragment,{children:[t.jsx("div",Object.assign({class:"oj-formlayout-inline-label",style:a},{children:t.jsx("oj-label",Object.assign({for:e.forid},{children:e.labelText}))})),t.jsx("div",Object.assign({class:"oj-formlayout-inline-value",style:r},{children:e.children}))]})}function i(e){return Array.isArray(e.children)||(e.children.props.labelEdge="provided"),t.jsxs(l.Fragment,{children:[t.jsx("oj-label",Object.assign({for:e.forid},{children:e.labelText})),e.children]})}function c(e){let o;if(e.children){const s=!Array.isArray(e.children);return s&&(o=n.ElementUtils.getUniqueId(e.children.props.id)),"start"===e.labelEdge?t.jsx(r,Object.assign({forid:o},e)):"top"===e.labelEdge?t.jsx(i,Object.assign({forid:o},e)):(s&&("inside"===e.labelEdge?(e.children.props.labelEdge=e.labelEdge,e.children.props.labelHint=e.labelText):e.children.props.labelEdge="none"),t.jsx(l.Fragment,{children:e.children}))}return null}class m extends l.Component{render(e){let l="oj-flex-item";const o=this._getFullFlexItemWidth(this.props.colspan,this.props.totalColumns);let s={flexGrow:"1",flexShrink:"1",flexBasis:o,width:o,maxWidth:o};return"start"==this.props.labelEdge&&(s.display="flex"),"formLayout"===this.props.contentType&&(l+=" oj-formlayout-nested-formlayout"),t.jsx("div",Object.assign({class:l,style:s},{children:t.jsx(c,Object.assign({labelText:this.props.labelText,labelEdge:this.props.labelEdge,labelWidth:this.props.labelWidth,colspan:this.props.colspan,totalColumns:this.props.totalColumns},{children:this.props.children}))}),e.cellKey)}_getFullFlexItemWidth(e,t){if(e===t)return"100%";let l=(o.parseJSONFromFontFamily("oj-form-layout-option-defaults")||{}).columnGap,s=(this.props.totalColumns,"calc(((100% / "+t+") - (("+l+" * ("+(t-1)+") / "+t+")))");return e>1&&(s+=" * "+e+" + ("+l+" * "+(e-1)+")"),s+=")",s}}m.defaultProps={colspan:1,totalColumns:1,labelEdge:"inside",labelWidth:"33%",labelText:""};class u extends l.Component{render(e){this._columns=e.columns>0?e.columns:e.maxColumns;const l="oj-form-layout oj-formlayout-max-cols-"+this._columns,o=this._getColumnFormContent(e.formControls,e.columns);return t.jsx("div",Object.assign({class:l},{children:o}))}_getColumnFormContent(e,l){let s,n,a,r=[];for(const l of e)n="function"==typeof l.content?l.content():l.content,a=l.labelEdge,a||(this._themeDefault||(this._themeDefault=o.parseJSONFromFontFamily("oj-form-layout-option-defaults")||{}),a=this._themeDefault.labelEdge),s=t.jsx(m,Object.assign({totalColumns:1,labelText:l.labelText,labelEdge:a,labelWidth:l.labelWidth,contentType:l.contentType,cellKey:l.key},{children:n})),r.push(t.jsx("div",Object.assign({class:"oj-flex","data-oj-internal":!0},{children:s})));const i=this._getColumnStyling(l);return t.jsx("div",Object.assign({class:i.formClassName,style:i.formStyle,"data-oj-context":!0,"data-oj-internal":!0},{children:r}))}_getColumnStyling(e){let t="oj-form";return this.props.readonly||(t+=" oj-enabled"),"efficient"===this.props.userAssistanceDensity&&(t+=" oj-efficient"),"truncate"===this.props.labelWrapping&&(t+=" oj-formlayout-labels-nowrap"),e>0&&(t+=" oj-form-layout-no-min-column-width"),t+=" oj-form-cols",{formClassName:t,formStyle:{columnCount:this._columns,webkitColumnCount:this._columns,MozColumnCount:this._columns}}}}u.defaultProps={colspanWrap:"nowrap",formControls:[],labelWrapping:"wrap",columns:0,maxColumns:1,readonly:!1,userAssistanceDensity:"efficient"};class d extends l.Component{constructor(){super(...arguments),this.setFormDivRef=e=>{this.formDivRef=e},this.state={availableColumns:0},this._updateAvailableColumns=()=>{if(0===this._calculateColumns(0)){const e=this.formDivRef,t=e.class;e.class="oj-form-layout";const l=this._calculateAvailableColumns(e);e.class=t,this.state.availableColumns!==l&&this.setState({availableColumns:l})}}}render(e){const l="oj-form-layout oj-formlayout-max-cols-"+(e.columns>0?e.columns+" oj-form-layout-no-min-column-width":e.maxColumns),o=this._getRowFormContent(this.props.formControls);return t.jsx("div",Object.assign({class:l,ref:this.setFormDivRef},{children:o}))}componentDidMount(){this._updateAvailableColumns(),a.addResizeListener(this.formDivRef,this._updateAvailableColumns,25)}componentDidUpdate(){this._updateAvailableColumns()}componentWillUnmount(){a.removeResizeListener(this.formDivRef,this._updateAvailableColumns)}_calculateAvailableColumns(e){let t=Math.max(this.props.maxColumns,1),l=parseFloat(window.getComputedStyle(e.querySelector(".oj-form")).columnWidth);if(!isNaN(l)){let e=this.formDivRef.getBoundingClientRect().width;t=Math.max(Math.floor(e/l),1)}return t}_calculateColumns(e){let t=Math.max(this.props.maxColumns,1);const l=this.props.columns;return l>0?t=l:t>1&&e<t&&(t=e),t}_getRowFormContent(e){let l,s=[];const n=this._calculateColumns(this.state.availableColumns);0===n&&(e=[]);let a,r,i,c,u=0,d=!1;for(const p of e){if(a=1,r=n,i="function"==typeof p.content?p.content():p.content,u%n==0&&(l&&this._addRowToForm(s,l,u),l=[]),p.colspan&&p.colspan>1){const e=u%n;let t=n-e;a=Math.floor(p.colspan),"wrap"===this.props.colspanWrap&&t<a&&e>0&&(this._addRowToForm(s,l,u),u+=t,l=[],t=n),a=Math.min(a,t),d=n>1}c=p.labelEdge,c||(this._themeDefault||(this._themeDefault=o.parseJSONFromFontFamily("oj-form-layout-option-defaults")||{}),c=this._themeDefault.labelEdge),l.push(t.jsx(m,Object.assign({colspan:a,totalColumns:r,labelText:p.labelText,labelEdge:c,labelWidth:p.labelWidth,contentType:p.contentType,cellKey:p.key},{children:i}))),u+=a,u%n!=0&&this._addColumnGutter(l)}this._addRowToForm(s,l,u);const p=this._getRowStyling(d);return t.jsx("div",Object.assign({class:p.formClassName,style:p.formStyle,"data-oj-context":!0,"data-oj-internal":!0},{children:s}))}_addColumnGutter(e){e.push(t.jsx("div",{class:"oj-formlayout-column-gutter"}))}_addRowToForm(e,l,o){this._addPaddingCells(l,o),e.push(t.jsx("div",Object.assign({class:"oj-flex","data-oj-internal":!0},{children:l})))}_addPaddingCells(e,l){const o=this._calculateColumns(this.state.availableColumns)||this.props.maxColumns,s=l%o;if(e&&s>0)for(let l=s;l<o;l++)l!==s&&this._addColumnGutter(e),e.push(t.jsx(m,{colspan:1,totalColumns:o,labelEdge:"none"}))}_getRowStyling(e){let t="oj-form";this.props.readonly||(t+=" oj-enabled"),"efficient"===this.props.userAssistanceDensity&&(t+=" oj-efficient"),"truncate"===this.props.labelWrapping&&(t+=" oj-formlayout-labels-nowrap"),e&&(t+=" oj-form-control-full-width"),t+=" oj-form-cols";return t+=" oj-formlayout-form-across",{formClassName:t,formStyle:{columnCount:1,webkitColumnCount:1,MozColumnCount:1}}}}d.defaultProps={colspanWrap:"nowrap",formControls:[],labelWrapping:"wrap",columns:0,maxColumns:1,readonly:!1,userAssistanceDensity:"efficient"};var p=function(e,t){var l={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(l[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(l[o[s]]=e[o[s]])}return l};class h extends l.Component{render(e){const{direction:l}=e,o=p(e,["direction"]);return"column"===l?t.jsx(u,Object.assign({},o)):t.jsx(d,Object.assign({},o))}}h.defaultProps={colspanWrap:"nowrap",direction:"row",formControls:[],labelWrapping:"wrap",columns:0,maxColumns:1,readonly:!1,userAssistanceDensity:"efficient"},e.VFormGenerator=h,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ojvformgenerator.js.map