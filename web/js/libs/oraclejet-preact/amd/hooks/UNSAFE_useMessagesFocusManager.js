define(["exports","preact/hooks"],(function(e,n){"use strict";const t=new Map,r=[],u=new Map;let o,c,i=!1;function s(e){0===t.size||"F6"!==e.key||e.defaultPrevented||function(e){var n,u,o;for(let i=function(e,n,t=-1){const r=e.indexOf(n);return-1!==r?r:t}(r,c,r.length)-1;i>-1;i--){const c=r[i],[s]=null!==(n=t.get(c))&&void 0!==n?n:[];if(null===(o=null===(u=null==s?void 0:s.current)||void 0===u?void 0:u.focus)||void 0===o?void 0:o.call(u))return e.preventDefault(),!0}return!1}(e)||c&&v(c,e)}function l(e){o=e.target}function d(e,n){var r;if(!t.has(e)||n.defaultPrevented)return;c=e;const[,i]=t.get(e);o&&!function(e){var n;for(const[r]of t.values())if(null===(n=r.current)||void 0===n?void 0:n.contains(e))return!0;return!1}(o)&&(u.set(e,o),null===(r=null==i?void 0:i.onFocus)||void 0===r||r.call(i))}function f(e,n,u){t.set(e,[n,u]),r.push(e)}function a(e){t.has(e)&&(t.delete(e),r.splice(r.indexOf(e),1))}function v(e,n){const t=function(e){for(let n=r.indexOf(e);n<r.length;n++)if(u.has(r[n]))return u.get(r[n]);return null}(e);return!(!t||!document.body.contains(t))&&(t.focus(),u.clear(),null==n||n.preventDefault(),!0)}const g={prioritize:function(e){if(!t.has(e))return;const[n,r]=t.get(e);a(e),f(e,n,r)},register:function(e,n,r){return i||(document.documentElement.addEventListener("keydown",s,!0),document.documentElement.addEventListener("blur",l,!0),i=!0),f(e,n,r),{onfocusin:n=>d(e,n),onfocusout:n=>function(e,n){t.has(e)&&!n.defaultPrevented&&(c=void 0)}(e,n),onKeyDown:n=>function(e,n){t.has(e)&&!n.defaultPrevented&&"keydown"===n.type&&["Escape"].includes(n.key)&&v(e,n)}(e,n)}},togglePreviousFocus:v,unregister:function(e){a(e),function(e){u.delete(e)}(e),i&&0===t.size&&(document.documentElement.removeEventListener("keydown",s,!0),document.documentElement.removeEventListener("blur",l,!0),i=!1)}};e.useMessageFocusManager=function(e,t){const r=n.useRef(Symbol()),u=n.useRef(g),[o,c]=n.useState({}),i=n.useMemo((()=>({prioritize:()=>u.current.prioritize(r.current),restorePriorFocus:()=>u.current.togglePreviousFocus(r.current)})),[u.current,r.current]);return n.useEffect((()=>(c(u.current.register(r.current,e,t)),()=>u.current.unregister(r.current))),[]),{handlers:o,controller:i}},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=UNSAFE_useMessagesFocusManager.js.map
